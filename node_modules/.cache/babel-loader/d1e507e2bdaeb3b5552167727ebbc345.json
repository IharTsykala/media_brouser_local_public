{"ast":null,"code":"import _slicedToArray from \"/home/ihartsykala/projects/playy/media_brouser_local_public/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _createForOfIteratorHelper from \"/home/ihartsykala/projects/playy/media_brouser_local_public/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\n\nvar __defNormalProp = function __defNormalProp(obj, key, value) {\n  return key in obj ? __defProp(obj, key, {\n    enumerable: true,\n    configurable: true,\n    writable: true,\n    value: value\n  }) : obj[key] = value;\n};\n\nvar __spreadValues = function __spreadValues(a, b) {\n  for (var prop in b || (b = {})) {\n    if (__hasOwnProp.call(b, prop)) __defNormalProp(a, prop, b[prop]);\n  }\n\n  if (__getOwnPropSymbols) {\n    var _iterator = _createForOfIteratorHelper(__getOwnPropSymbols(b)),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var prop = _step.value;\n        if (__propIsEnum.call(b, prop)) __defNormalProp(a, prop, b[prop]);\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n  }\n\n  return a;\n};\n\nvar __spreadProps = function __spreadProps(a, b) {\n  return __defProps(a, __getOwnPropDescs(b));\n};\n\nvar __objRest = function __objRest(source, exclude) {\n  var target = {};\n\n  for (var prop in source) {\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0) target[prop] = source[prop];\n  }\n\n  if (source != null && __getOwnPropSymbols) {\n    var _iterator2 = _createForOfIteratorHelper(__getOwnPropSymbols(source)),\n        _step2;\n\n    try {\n      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n        var prop = _step2.value;\n        if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop)) target[prop] = source[prop];\n      }\n    } catch (err) {\n      _iterator2.e(err);\n    } finally {\n      _iterator2.f();\n    }\n  }\n\n  return target;\n};\n\nimport { ChevronDownIcon } from \"@sanity/icons\";\nimport React, { cloneElement, forwardRef, useCallback, useEffect, useMemo, useReducer, useRef, useState } from \"react\";\nimport { EMPTY_ARRAY } from \"../../constants\";\nimport { _hasFocus, _raf, focusFirstDescendant } from \"../../helpers\";\nimport { useForwardedRef, useResponsiveProp } from \"../../hooks\";\nimport { Box, Button, Card, Stack, Text, TextInput } from \"../../primitives\";\nimport { AnimatedSpinnerIcon, ListBox, ResultsPopover, Root } from \"./autocomplete.styles\";\nimport { AutocompleteOption } from \"./autocompleteOption\";\nimport { autocompleteReducer } from \"./autocompleteReducer\";\nimport { EMPTY_RECORD, AUTOCOMPLETE_LISTBOX_IGNORE_KEYS, AUTOCOMPLETE_POPOVER_FALLBACK_PLACEMENTS, AUTOCOMPLETE_POPOVER_MARGINS, AUTOCOMPLETE_POPOVER_PLACEMENT } from \"./constants\";\n\nvar defaultRenderValue = function defaultRenderValue(value, option) {\n  return option ? option.value : value;\n};\n\nvar defaultFilterOption = function defaultFilterOption(query, option) {\n  return option.value.toLowerCase().indexOf(query.toLowerCase()) > -1;\n};\n\nvar InnerAutocomplete = forwardRef(function InnerAutocomplete2(props, ref) {\n  var _a = props,\n      _a$border = _a.border,\n      border = _a$border === void 0 ? true : _a$border,\n      customValidity = _a.customValidity,\n      disabled = _a.disabled,\n      filterOptionProp = _a.filterOption,\n      _a$fontSize = _a.fontSize,\n      fontSize = _a$fontSize === void 0 ? 2 : _a$fontSize,\n      icon = _a.icon,\n      id = _a.id,\n      _a$listBox = _a.listBox,\n      listBox = _a$listBox === void 0 ? {} : _a$listBox,\n      loading = _a.loading,\n      onBlur = _a.onBlur,\n      onChange = _a.onChange,\n      onFocus = _a.onFocus,\n      onQueryChange = _a.onQueryChange,\n      onSelect = _a.onSelect,\n      openButton = _a.openButton,\n      optionsProp = _a.options,\n      _a$padding = _a.padding,\n      paddingProp = _a$padding === void 0 ? 3 : _a$padding,\n      _a$popover = _a.popover,\n      popover = _a$popover === void 0 ? {} : _a$popover,\n      prefix = _a.prefix,\n      _a$radius = _a.radius,\n      radius = _a$radius === void 0 ? 3 : _a$radius,\n      readOnly = _a.readOnly,\n      relatedElements = _a.relatedElements,\n      renderOptionProp = _a.renderOption,\n      renderPopover = _a.renderPopover,\n      _a$renderValue = _a.renderValue,\n      renderValue = _a$renderValue === void 0 ? defaultRenderValue : _a$renderValue,\n      valueProp = _a.value,\n      restProps = __objRest(_a, [\"border\", \"customValidity\", \"disabled\", \"filterOption\", \"fontSize\", \"icon\", \"id\", \"listBox\", \"loading\", \"onBlur\", \"onChange\", \"onFocus\", \"onQueryChange\", \"onSelect\", \"openButton\", \"options\", \"padding\", \"popover\", \"prefix\", \"radius\", \"readOnly\", \"relatedElements\", \"renderOption\", \"renderPopover\", \"renderValue\", \"value\"]);\n\n  var _useReducer = useReducer(autocompleteReducer, {\n    activeValue: valueProp || null,\n    focused: false,\n    listFocused: false,\n    query: null,\n    value: valueProp || null\n  }),\n      _useReducer2 = _slicedToArray(_useReducer, 2),\n      state = _useReducer2[0],\n      dispatch = _useReducer2[1];\n\n  var activeValue = state.activeValue,\n      focused = state.focused,\n      listFocused = state.listFocused,\n      query = state.query,\n      value = state.value;\n  var defaultRenderOption = useCallback(function (_ref) {\n    var value2 = _ref.value;\n    return /* @__PURE__ */React.createElement(Card, {\n      \"data-as\": \"button\",\n      padding: paddingProp,\n      radius: 2,\n      tone: \"inherit\"\n    }, /* @__PURE__ */React.createElement(Text, {\n      size: fontSize,\n      textOverflow: \"ellipsis\"\n    }, value2));\n  }, [fontSize, paddingProp]);\n  var renderOption = typeof renderOptionProp === \"function\" ? renderOptionProp : defaultRenderOption;\n  var filterOption = typeof filterOptionProp === \"function\" ? filterOptionProp : defaultFilterOption;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      rootElement = _useState2[0],\n      setRootElement = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      resultsPopoverElement = _useState4[0],\n      setResultsPopoverElement = _useState4[1];\n\n  var inputElementRef = useRef(null);\n  var listBoxElementRef = useRef(null);\n  var focusedElementRef = useRef(null);\n  var valueRef = useRef(value);\n  var valuePropRef = useRef(valueProp);\n  var forwardedRef = useForwardedRef(ref);\n  var popoverMouseWithinRef = useRef(false);\n  var listBoxId = \"\".concat(id, \"-listbox\");\n  var options = Array.isArray(optionsProp) ? optionsProp : EMPTY_ARRAY;\n  var padding = useResponsiveProp(paddingProp);\n  var currentOption = useMemo(function () {\n    return value !== null ? options.find(function (o) {\n      return o.value === value;\n    }) : void 0;\n  }, [options, value]);\n  var filteredOptions = useMemo(function () {\n    return options.filter(function (option) {\n      return query ? filterOption(query, option) : true;\n    });\n  }, [filterOption, options, query]);\n  var filteredOptionsLen = filteredOptions.length;\n  var activeItemId = activeValue ? \"\".concat(id, \"-option-\").concat(activeValue) : void 0;\n  var expanded = query !== null && loading || focused && query !== null;\n  var handleRootBlur = useCallback(function (event) {\n    setTimeout(function () {\n      if (popoverMouseWithinRef.current) {\n        return;\n      }\n\n      var elements = (relatedElements || []).concat(rootElement ? [rootElement] : [], resultsPopoverElement ? [resultsPopoverElement] : []);\n      var focusInside = false;\n\n      if (document.activeElement) {\n        var _iterator3 = _createForOfIteratorHelper(elements),\n            _step3;\n\n        try {\n          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n            var e = _step3.value;\n\n            if (e === document.activeElement || e.contains(document.activeElement)) {\n              focusInside = true;\n              break;\n            }\n          }\n        } catch (err) {\n          _iterator3.e(err);\n        } finally {\n          _iterator3.f();\n        }\n      }\n\n      if (focusInside === false) {\n        dispatch({\n          type: \"root/blur\"\n        });\n        popoverMouseWithinRef.current = false;\n        if (onQueryChange) onQueryChange(null);\n        if (onBlur) onBlur(event);\n      }\n    }, 0);\n  }, [onBlur, onQueryChange, relatedElements, resultsPopoverElement, rootElement]);\n  var handleRootFocus = useCallback(function (event) {\n    var listBoxElement = listBoxElementRef.current;\n    var focusedElement = event.target instanceof HTMLElement ? event.target : null;\n    focusedElementRef.current = focusedElement;\n    var nextListFocused = Boolean(listBoxElement && focusedElement && listBoxElement.contains(focusedElement));\n    dispatch({\n      type: \"root/setListFocused\",\n      listFocused: nextListFocused\n    });\n  }, []);\n  var handleOptionSelect = useCallback(function (v) {\n    var _a2;\n\n    dispatch({\n      type: \"value/change\",\n      value: v\n    });\n    popoverMouseWithinRef.current = false;\n    if (onSelect) onSelect(v);\n    valueRef.current = v;\n    if (onChange) onChange(v);\n    if (onQueryChange) onQueryChange(null);\n    (_a2 = inputElementRef.current) == null ? void 0 : _a2.focus();\n  }, [onChange, onSelect, onQueryChange]);\n  var handleRootKeyDown = useCallback(function (event) {\n    var _a2, _b;\n\n    if (event.key === \"ArrowDown\") {\n      event.preventDefault();\n      if (!filteredOptionsLen) return;\n      var activeOption = filteredOptions.find(function (o) {\n        return o.value === activeValue;\n      });\n      var activeIndex = activeOption ? filteredOptions.indexOf(activeOption) : -1;\n      var nextActiveOption = filteredOptions[(activeIndex + 1) % filteredOptionsLen];\n\n      if (nextActiveOption) {\n        dispatch({\n          type: \"root/setActiveValue\",\n          value: nextActiveOption.value,\n          listFocused: true\n        });\n      }\n\n      return;\n    }\n\n    if (event.key === \"ArrowUp\") {\n      event.preventDefault();\n      if (!filteredOptionsLen) return;\n\n      var _activeOption = filteredOptions.find(function (o) {\n        return o.value === activeValue;\n      });\n\n      var _activeIndex = _activeOption ? filteredOptions.indexOf(_activeOption) : -1;\n\n      var _nextActiveOption = filteredOptions[_activeIndex === -1 ? filteredOptionsLen - 1 : (filteredOptionsLen + _activeIndex - 1) % filteredOptionsLen];\n\n      if (_nextActiveOption) {\n        dispatch({\n          type: \"root/setActiveValue\",\n          value: _nextActiveOption.value,\n          listFocused: true\n        });\n      }\n\n      return;\n    }\n\n    if (event.key === \"Escape\") {\n      dispatch({\n        type: \"root/escape\"\n      });\n      popoverMouseWithinRef.current = false;\n      if (onQueryChange) onQueryChange(null);\n      (_a2 = inputElementRef.current) == null ? void 0 : _a2.focus();\n      return;\n    }\n\n    var target = event.target;\n    var listEl = listBoxElementRef.current;\n\n    if ((listEl === target || (listEl == null ? void 0 : listEl.contains(target))) && !AUTOCOMPLETE_LISTBOX_IGNORE_KEYS.includes(event.key)) {\n      (_b = inputElementRef.current) == null ? void 0 : _b.focus();\n      return;\n    }\n  }, [activeValue, filteredOptions, filteredOptionsLen, onQueryChange]);\n  var handleInputChange = useCallback(function (event) {\n    var nextQuery = event.currentTarget.value;\n    dispatch({\n      type: \"input/change\",\n      query: nextQuery\n    });\n    if (onQueryChange) onQueryChange(nextQuery);\n  }, [onQueryChange]);\n  var handleInputFocus = useCallback(function (event) {\n    if (!focused) {\n      dispatch({\n        type: \"input/focus\"\n      });\n      if (onFocus) onFocus(event);\n    }\n  }, [focused, onFocus]);\n  var handlePopoverMouseEnter = useCallback(function () {\n    popoverMouseWithinRef.current = true;\n  }, []);\n  var handlePopoverMouseLeave = useCallback(function () {\n    popoverMouseWithinRef.current = false;\n  }, []);\n  var handleClearButtonClick = useCallback(function () {\n    var _a2;\n\n    dispatch({\n      type: \"root/clear\"\n    });\n    valueRef.current = \"\";\n    if (onChange) onChange(\"\");\n    if (onQueryChange) onQueryChange(null);\n    (_a2 = inputElementRef.current) == null ? void 0 : _a2.focus();\n  }, [onChange, onQueryChange]);\n  var handleClearButtonFocus = useCallback(function () {\n    dispatch({\n      type: \"input/focus\"\n    });\n  }, []);\n  useEffect(function () {\n    if (valueProp !== valuePropRef.current) {\n      valuePropRef.current = valueProp;\n\n      if (valueProp !== void 0) {\n        dispatch({\n          type: \"value/change\",\n          value: valueProp\n        });\n        valueRef.current = valueProp;\n      }\n\n      return;\n    }\n\n    if (valueProp !== value) {\n      dispatch({\n        type: \"value/change\",\n        value: valueProp || null\n      });\n    }\n  }, [valueProp, value]);\n  useEffect(function () {\n    if (!focused) {\n      if (valueRef.current) {\n        dispatch({\n          type: \"root/setActiveValue\",\n          value: valueRef.current\n        });\n      }\n    }\n  }, [focused]);\n  useEffect(function () {\n    var listElement = listBoxElementRef.current;\n    if (!listElement) return;\n    var activeOption = filteredOptions.find(function (o) {\n      return o.value === activeValue;\n    });\n\n    if (activeOption) {\n      var activeIndex = filteredOptions.indexOf(activeOption);\n      var activeItemElement = listElement.childNodes[activeIndex];\n\n      if (activeItemElement) {\n        if (_hasFocus(activeItemElement)) {\n          return;\n        }\n\n        focusFirstDescendant(activeItemElement);\n      }\n    }\n  }, [activeValue, filteredOptions]);\n  var setRef = useCallback(function (el) {\n    inputElementRef.current = el;\n    forwardedRef.current = el;\n  }, [forwardedRef]);\n  var clearButton = useMemo(function () {\n    if (!loading && !disabled && value) {\n      return {\n        \"aria-label\": \"Clear\",\n        onFocus: handleClearButtonFocus\n      };\n    }\n\n    return void 0;\n  }, [disabled, handleClearButtonFocus, loading, value]);\n  var openButtonBoxPadding = useMemo(function () {\n    return padding.map(function (v) {\n      return v - 2;\n    });\n  }, [padding]);\n  var openButtonPadding = useMemo(function () {\n    return padding.map(function (v) {\n      return v - 1;\n    });\n  }, [padding]);\n  var openButtonProps = useMemo(function () {\n    return typeof openButton === \"object\" ? openButton : EMPTY_RECORD;\n  }, [openButton]);\n  var handleOpenClick = useCallback(function (event) {\n    dispatch({\n      type: \"root/open\",\n      query: value ? renderValue(value, currentOption) : \"\"\n    });\n    if (openButtonProps.onClick) openButtonProps.onClick(event);\n\n    _raf(function () {\n      var _a2;\n\n      return (_a2 = inputElementRef.current) == null ? void 0 : _a2.focus();\n    });\n  }, [currentOption, openButtonProps, renderValue, value]);\n  var openButtonNode = useMemo(function () {\n    return !disabled && !readOnly && openButton ? /* @__PURE__ */React.createElement(Box, {\n      \"aria-hidden\": expanded,\n      padding: openButtonBoxPadding\n    }, /* @__PURE__ */React.createElement(Button, __spreadProps(__spreadValues({\n      \"aria-label\": \"Open\",\n      disabled: expanded,\n      fontSize: fontSize,\n      icon: ChevronDownIcon,\n      mode: \"bleed\",\n      padding: openButtonPadding\n    }, openButtonProps), {\n      onClick: handleOpenClick\n    }))) : void 0;\n  }, [disabled, expanded, fontSize, handleOpenClick, openButton, openButtonBoxPadding, openButtonPadding, openButtonProps, readOnly]);\n  var inputValue = useMemo(function () {\n    if (query === null) {\n      if (value !== null) {\n        return renderValue(value, currentOption);\n      }\n\n      return \"\";\n    }\n\n    return query;\n  }, [currentOption, query, renderValue, value]);\n  var input = /* @__PURE__ */React.createElement(TextInput, __spreadProps(__spreadValues({}, restProps), {\n    \"aria-activedescendant\": activeItemId,\n    \"aria-autocomplete\": \"list\",\n    \"aria-expanded\": expanded,\n    \"aria-owns\": listBoxId,\n    autoCapitalize: \"off\",\n    autoComplete: \"off\",\n    autoCorrect: \"off\",\n    border: border,\n    clearButton: clearButton,\n    customValidity: customValidity,\n    disabled: disabled,\n    fontSize: fontSize,\n    icon: icon,\n    iconRight: loading && AnimatedSpinnerIcon,\n    id: id,\n    inputMode: \"search\",\n    onChange: handleInputChange,\n    onClear: handleClearButtonClick,\n    onFocus: handleInputFocus,\n    padding: padding,\n    prefix: prefix,\n    radius: radius,\n    readOnly: readOnly,\n    ref: setRef,\n    role: \"combobox\",\n    spellCheck: false,\n    suffix: openButtonNode,\n    value: inputValue\n  }));\n  var handleListBoxKeyDown = useCallback(function (event) {\n    var _a2;\n\n    if (event.key === \"Tab\") {\n      if (listFocused) (_a2 = inputElementRef.current) == null ? void 0 : _a2.focus();\n    }\n  }, [listFocused]);\n  var content = useMemo(function () {\n    if (filteredOptions.length === 0) return null;\n    return /* @__PURE__ */React.createElement(ListBox, __spreadProps(__spreadValues({\n      onKeyDown: handleListBoxKeyDown,\n      padding: 1\n    }, listBox), {\n      tabIndex: -1\n    }), /* @__PURE__ */React.createElement(Stack, {\n      as: \"ul\",\n      \"aria-multiselectable\": false,\n      id: listBoxId,\n      ref: listBoxElementRef,\n      role: \"listbox\",\n      space: 1\n    }, filteredOptions.map(function (option) {\n      var active = activeValue !== null ? option.value === activeValue : currentOption === option;\n      return /* @__PURE__ */React.createElement(AutocompleteOption, {\n        id: \"\".concat(id, \"-option-\").concat(option.value),\n        key: option.value,\n        onSelect: handleOptionSelect,\n        selected: active,\n        value: option.value\n      }, cloneElement(renderOption(option), {\n        disabled: loading,\n        selected: active,\n        tabIndex: listFocused && active ? 0 : -1\n      }));\n    })));\n  }, [activeValue, currentOption, filteredOptions, handleOptionSelect, handleListBoxKeyDown, id, listBox, listBoxId, listFocused, loading, renderOption]);\n  var results = useMemo(function () {\n    if (renderPopover) {\n      return renderPopover({\n        content: content,\n        hidden: !expanded,\n        inputElement: inputElementRef.current\n      }, setResultsPopoverElement);\n    }\n\n    if (filteredOptionsLen === 0) {\n      return null;\n    }\n\n    return /* @__PURE__ */React.createElement(ResultsPopover, __spreadValues({\n      __unstable_margins: AUTOCOMPLETE_POPOVER_MARGINS,\n      arrow: false,\n      constrainSize: true,\n      content: content,\n      fallbackPlacements: AUTOCOMPLETE_POPOVER_FALLBACK_PLACEMENTS,\n      matchReferenceWidth: true,\n      onMouseEnter: handlePopoverMouseEnter,\n      onMouseLeave: handlePopoverMouseLeave,\n      open: expanded,\n      placement: AUTOCOMPLETE_POPOVER_PLACEMENT,\n      portal: true,\n      radius: radius,\n      ref: setResultsPopoverElement,\n      referenceElement: inputElementRef.current\n    }, popover));\n  }, [content, expanded, filteredOptionsLen, handlePopoverMouseEnter, handlePopoverMouseLeave, popover, radius, renderPopover]);\n  return /* @__PURE__ */React.createElement(Root, {\n    \"data-ui\": \"Autocomplete\",\n    onBlur: handleRootBlur,\n    onFocus: handleRootFocus,\n    onKeyDown: handleRootKeyDown,\n    ref: setRootElement\n  }, input, results);\n});\nvar Autocomplete = InnerAutocomplete;\nexport { Autocomplete };","map":{"version":3,"sources":["/home/ihartsykala/projects/playy/media_brouser_local_public/node_modules/@sanity/ui/lib/esm/components/autocomplete/autocomplete.js"],"names":["__defProp","Object","defineProperty","__defProps","defineProperties","__getOwnPropDescs","getOwnPropertyDescriptors","__getOwnPropSymbols","getOwnPropertySymbols","__hasOwnProp","prototype","hasOwnProperty","__propIsEnum","propertyIsEnumerable","__defNormalProp","obj","key","value","enumerable","configurable","writable","__spreadValues","a","b","prop","call","__spreadProps","__objRest","source","exclude","target","indexOf","ChevronDownIcon","React","cloneElement","forwardRef","useCallback","useEffect","useMemo","useReducer","useRef","useState","EMPTY_ARRAY","_hasFocus","_raf","focusFirstDescendant","useForwardedRef","useResponsiveProp","Box","Button","Card","Stack","Text","TextInput","AnimatedSpinnerIcon","ListBox","ResultsPopover","Root","AutocompleteOption","autocompleteReducer","EMPTY_RECORD","AUTOCOMPLETE_LISTBOX_IGNORE_KEYS","AUTOCOMPLETE_POPOVER_FALLBACK_PLACEMENTS","AUTOCOMPLETE_POPOVER_MARGINS","AUTOCOMPLETE_POPOVER_PLACEMENT","defaultRenderValue","option","defaultFilterOption","query","toLowerCase","InnerAutocomplete","InnerAutocomplete2","props","ref","_a","border","customValidity","disabled","filterOptionProp","filterOption","fontSize","icon","id","listBox","loading","onBlur","onChange","onFocus","onQueryChange","onSelect","openButton","optionsProp","options","padding","paddingProp","popover","prefix","radius","readOnly","relatedElements","renderOptionProp","renderOption","renderPopover","renderValue","valueProp","restProps","activeValue","focused","listFocused","state","dispatch","defaultRenderOption","value2","createElement","tone","size","textOverflow","rootElement","setRootElement","resultsPopoverElement","setResultsPopoverElement","inputElementRef","listBoxElementRef","focusedElementRef","valueRef","valuePropRef","forwardedRef","popoverMouseWithinRef","listBoxId","Array","isArray","currentOption","find","o","filteredOptions","filter","filteredOptionsLen","length","activeItemId","expanded","handleRootBlur","event","setTimeout","current","elements","concat","focusInside","document","activeElement","e","contains","type","handleRootFocus","listBoxElement","focusedElement","HTMLElement","nextListFocused","Boolean","handleOptionSelect","v","_a2","focus","handleRootKeyDown","_b","preventDefault","activeOption","activeIndex","nextActiveOption","listEl","includes","handleInputChange","nextQuery","currentTarget","handleInputFocus","handlePopoverMouseEnter","handlePopoverMouseLeave","handleClearButtonClick","handleClearButtonFocus","listElement","activeItemElement","childNodes","setRef","el","clearButton","openButtonBoxPadding","map","openButtonPadding","openButtonProps","handleOpenClick","onClick","openButtonNode","mode","inputValue","input","autoCapitalize","autoComplete","autoCorrect","iconRight","inputMode","onClear","role","spellCheck","suffix","handleListBoxKeyDown","content","onKeyDown","tabIndex","as","space","active","selected","results","hidden","inputElement","__unstable_margins","arrow","constrainSize","fallbackPlacements","matchReferenceWidth","onMouseEnter","onMouseLeave","open","placement","portal","referenceElement","Autocomplete"],"mappings":"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","sourcesContent":["var __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nimport { ChevronDownIcon } from \"@sanity/icons\";\nimport React, {\n  cloneElement,\n  forwardRef,\n  useCallback,\n  useEffect,\n  useMemo,\n  useReducer,\n  useRef,\n  useState\n} from \"react\";\nimport { EMPTY_ARRAY } from \"../../constants\";\nimport { _hasFocus, _raf, focusFirstDescendant } from \"../../helpers\";\nimport { useForwardedRef, useResponsiveProp } from \"../../hooks\";\nimport { Box, Button, Card, Stack, Text, TextInput } from \"../../primitives\";\nimport { AnimatedSpinnerIcon, ListBox, ResultsPopover, Root } from \"./autocomplete.styles\";\nimport { AutocompleteOption } from \"./autocompleteOption\";\nimport { autocompleteReducer } from \"./autocompleteReducer\";\nimport {\n  EMPTY_RECORD,\n  AUTOCOMPLETE_LISTBOX_IGNORE_KEYS,\n  AUTOCOMPLETE_POPOVER_FALLBACK_PLACEMENTS,\n  AUTOCOMPLETE_POPOVER_MARGINS,\n  AUTOCOMPLETE_POPOVER_PLACEMENT\n} from \"./constants\";\nconst defaultRenderValue = (value, option) => option ? option.value : value;\nconst defaultFilterOption = (query, option) => option.value.toLowerCase().indexOf(query.toLowerCase()) > -1;\nconst InnerAutocomplete = forwardRef(function InnerAutocomplete2(props, ref) {\n  const _a = props, {\n    border = true,\n    customValidity,\n    disabled,\n    filterOption: filterOptionProp,\n    fontSize = 2,\n    icon,\n    id,\n    listBox = {},\n    loading,\n    onBlur,\n    onChange,\n    onFocus,\n    onQueryChange,\n    onSelect,\n    openButton,\n    options: optionsProp,\n    padding: paddingProp = 3,\n    popover = {},\n    prefix,\n    radius = 3,\n    readOnly,\n    relatedElements,\n    renderOption: renderOptionProp,\n    renderPopover,\n    renderValue = defaultRenderValue,\n    value: valueProp\n  } = _a, restProps = __objRest(_a, [\n    \"border\",\n    \"customValidity\",\n    \"disabled\",\n    \"filterOption\",\n    \"fontSize\",\n    \"icon\",\n    \"id\",\n    \"listBox\",\n    \"loading\",\n    \"onBlur\",\n    \"onChange\",\n    \"onFocus\",\n    \"onQueryChange\",\n    \"onSelect\",\n    \"openButton\",\n    \"options\",\n    \"padding\",\n    \"popover\",\n    \"prefix\",\n    \"radius\",\n    \"readOnly\",\n    \"relatedElements\",\n    \"renderOption\",\n    \"renderPopover\",\n    \"renderValue\",\n    \"value\"\n  ]);\n  const [state, dispatch] = useReducer(autocompleteReducer, {\n    activeValue: valueProp || null,\n    focused: false,\n    listFocused: false,\n    query: null,\n    value: valueProp || null\n  });\n  const { activeValue, focused, listFocused, query, value } = state;\n  const defaultRenderOption = useCallback(({ value: value2 }) => /* @__PURE__ */ React.createElement(Card, {\n    \"data-as\": \"button\",\n    padding: paddingProp,\n    radius: 2,\n    tone: \"inherit\"\n  }, /* @__PURE__ */ React.createElement(Text, {\n    size: fontSize,\n    textOverflow: \"ellipsis\"\n  }, value2)), [fontSize, paddingProp]);\n  const renderOption = typeof renderOptionProp === \"function\" ? renderOptionProp : defaultRenderOption;\n  const filterOption = typeof filterOptionProp === \"function\" ? filterOptionProp : defaultFilterOption;\n  const [rootElement, setRootElement] = useState(null);\n  const [resultsPopoverElement, setResultsPopoverElement] = useState(null);\n  const inputElementRef = useRef(null);\n  const listBoxElementRef = useRef(null);\n  const focusedElementRef = useRef(null);\n  const valueRef = useRef(value);\n  const valuePropRef = useRef(valueProp);\n  const forwardedRef = useForwardedRef(ref);\n  const popoverMouseWithinRef = useRef(false);\n  const listBoxId = `${id}-listbox`;\n  const options = Array.isArray(optionsProp) ? optionsProp : EMPTY_ARRAY;\n  const padding = useResponsiveProp(paddingProp);\n  const currentOption = useMemo(() => value !== null ? options.find((o) => o.value === value) : void 0, [options, value]);\n  const filteredOptions = useMemo(() => options.filter((option) => query ? filterOption(query, option) : true), [filterOption, options, query]);\n  const filteredOptionsLen = filteredOptions.length;\n  const activeItemId = activeValue ? `${id}-option-${activeValue}` : void 0;\n  const expanded = query !== null && loading || focused && query !== null;\n  const handleRootBlur = useCallback((event) => {\n    setTimeout(() => {\n      if (popoverMouseWithinRef.current) {\n        return;\n      }\n      const elements = (relatedElements || []).concat(rootElement ? [rootElement] : [], resultsPopoverElement ? [resultsPopoverElement] : []);\n      let focusInside = false;\n      if (document.activeElement) {\n        for (const e of elements) {\n          if (e === document.activeElement || e.contains(document.activeElement)) {\n            focusInside = true;\n            break;\n          }\n        }\n      }\n      if (focusInside === false) {\n        dispatch({ type: \"root/blur\" });\n        popoverMouseWithinRef.current = false;\n        if (onQueryChange)\n          onQueryChange(null);\n        if (onBlur)\n          onBlur(event);\n      }\n    }, 0);\n  }, [onBlur, onQueryChange, relatedElements, resultsPopoverElement, rootElement]);\n  const handleRootFocus = useCallback((event) => {\n    const listBoxElement = listBoxElementRef.current;\n    const focusedElement = event.target instanceof HTMLElement ? event.target : null;\n    focusedElementRef.current = focusedElement;\n    const nextListFocused = Boolean(listBoxElement && focusedElement && listBoxElement.contains(focusedElement));\n    dispatch({ type: \"root/setListFocused\", listFocused: nextListFocused });\n  }, []);\n  const handleOptionSelect = useCallback((v) => {\n    var _a2;\n    dispatch({ type: \"value/change\", value: v });\n    popoverMouseWithinRef.current = false;\n    if (onSelect)\n      onSelect(v);\n    valueRef.current = v;\n    if (onChange)\n      onChange(v);\n    if (onQueryChange)\n      onQueryChange(null);\n    (_a2 = inputElementRef.current) == null ? void 0 : _a2.focus();\n  }, [onChange, onSelect, onQueryChange]);\n  const handleRootKeyDown = useCallback((event) => {\n    var _a2, _b;\n    if (event.key === \"ArrowDown\") {\n      event.preventDefault();\n      if (!filteredOptionsLen)\n        return;\n      const activeOption = filteredOptions.find((o) => o.value === activeValue);\n      const activeIndex = activeOption ? filteredOptions.indexOf(activeOption) : -1;\n      const nextActiveOption = filteredOptions[(activeIndex + 1) % filteredOptionsLen];\n      if (nextActiveOption) {\n        dispatch({ type: \"root/setActiveValue\", value: nextActiveOption.value, listFocused: true });\n      }\n      return;\n    }\n    if (event.key === \"ArrowUp\") {\n      event.preventDefault();\n      if (!filteredOptionsLen)\n        return;\n      const activeOption = filteredOptions.find((o) => o.value === activeValue);\n      const activeIndex = activeOption ? filteredOptions.indexOf(activeOption) : -1;\n      const nextActiveOption = filteredOptions[activeIndex === -1 ? filteredOptionsLen - 1 : (filteredOptionsLen + activeIndex - 1) % filteredOptionsLen];\n      if (nextActiveOption) {\n        dispatch({ type: \"root/setActiveValue\", value: nextActiveOption.value, listFocused: true });\n      }\n      return;\n    }\n    if (event.key === \"Escape\") {\n      dispatch({ type: \"root/escape\" });\n      popoverMouseWithinRef.current = false;\n      if (onQueryChange)\n        onQueryChange(null);\n      (_a2 = inputElementRef.current) == null ? void 0 : _a2.focus();\n      return;\n    }\n    const target = event.target;\n    const listEl = listBoxElementRef.current;\n    if ((listEl === target || (listEl == null ? void 0 : listEl.contains(target))) && !AUTOCOMPLETE_LISTBOX_IGNORE_KEYS.includes(event.key)) {\n      (_b = inputElementRef.current) == null ? void 0 : _b.focus();\n      return;\n    }\n  }, [activeValue, filteredOptions, filteredOptionsLen, onQueryChange]);\n  const handleInputChange = useCallback((event) => {\n    const nextQuery = event.currentTarget.value;\n    dispatch({ type: \"input/change\", query: nextQuery });\n    if (onQueryChange)\n      onQueryChange(nextQuery);\n  }, [onQueryChange]);\n  const handleInputFocus = useCallback((event) => {\n    if (!focused) {\n      dispatch({ type: \"input/focus\" });\n      if (onFocus)\n        onFocus(event);\n    }\n  }, [focused, onFocus]);\n  const handlePopoverMouseEnter = useCallback(() => {\n    popoverMouseWithinRef.current = true;\n  }, []);\n  const handlePopoverMouseLeave = useCallback(() => {\n    popoverMouseWithinRef.current = false;\n  }, []);\n  const handleClearButtonClick = useCallback(() => {\n    var _a2;\n    dispatch({ type: \"root/clear\" });\n    valueRef.current = \"\";\n    if (onChange)\n      onChange(\"\");\n    if (onQueryChange)\n      onQueryChange(null);\n    (_a2 = inputElementRef.current) == null ? void 0 : _a2.focus();\n  }, [onChange, onQueryChange]);\n  const handleClearButtonFocus = useCallback(() => {\n    dispatch({ type: \"input/focus\" });\n  }, []);\n  useEffect(() => {\n    if (valueProp !== valuePropRef.current) {\n      valuePropRef.current = valueProp;\n      if (valueProp !== void 0) {\n        dispatch({ type: \"value/change\", value: valueProp });\n        valueRef.current = valueProp;\n      }\n      return;\n    }\n    if (valueProp !== value) {\n      dispatch({ type: \"value/change\", value: valueProp || null });\n    }\n  }, [valueProp, value]);\n  useEffect(() => {\n    if (!focused) {\n      if (valueRef.current) {\n        dispatch({ type: \"root/setActiveValue\", value: valueRef.current });\n      }\n    }\n  }, [focused]);\n  useEffect(() => {\n    const listElement = listBoxElementRef.current;\n    if (!listElement)\n      return;\n    const activeOption = filteredOptions.find((o) => o.value === activeValue);\n    if (activeOption) {\n      const activeIndex = filteredOptions.indexOf(activeOption);\n      const activeItemElement = listElement.childNodes[activeIndex];\n      if (activeItemElement) {\n        if (_hasFocus(activeItemElement)) {\n          return;\n        }\n        focusFirstDescendant(activeItemElement);\n      }\n    }\n  }, [activeValue, filteredOptions]);\n  const setRef = useCallback((el) => {\n    inputElementRef.current = el;\n    forwardedRef.current = el;\n  }, [forwardedRef]);\n  const clearButton = useMemo(() => {\n    if (!loading && !disabled && value) {\n      return {\n        \"aria-label\": \"Clear\",\n        onFocus: handleClearButtonFocus\n      };\n    }\n    return void 0;\n  }, [disabled, handleClearButtonFocus, loading, value]);\n  const openButtonBoxPadding = useMemo(() => padding.map((v) => v - 2), [padding]);\n  const openButtonPadding = useMemo(() => padding.map((v) => v - 1), [padding]);\n  const openButtonProps = useMemo(() => typeof openButton === \"object\" ? openButton : EMPTY_RECORD, [openButton]);\n  const handleOpenClick = useCallback((event) => {\n    dispatch({\n      type: \"root/open\",\n      query: value ? renderValue(value, currentOption) : \"\"\n    });\n    if (openButtonProps.onClick)\n      openButtonProps.onClick(event);\n    _raf(() => {\n      var _a2;\n      return (_a2 = inputElementRef.current) == null ? void 0 : _a2.focus();\n    });\n  }, [currentOption, openButtonProps, renderValue, value]);\n  const openButtonNode = useMemo(() => !disabled && !readOnly && openButton ? /* @__PURE__ */ React.createElement(Box, {\n    \"aria-hidden\": expanded,\n    padding: openButtonBoxPadding\n  }, /* @__PURE__ */ React.createElement(Button, __spreadProps(__spreadValues({\n    \"aria-label\": \"Open\",\n    disabled: expanded,\n    fontSize,\n    icon: ChevronDownIcon,\n    mode: \"bleed\",\n    padding: openButtonPadding\n  }, openButtonProps), {\n    onClick: handleOpenClick\n  }))) : void 0, [\n    disabled,\n    expanded,\n    fontSize,\n    handleOpenClick,\n    openButton,\n    openButtonBoxPadding,\n    openButtonPadding,\n    openButtonProps,\n    readOnly\n  ]);\n  const inputValue = useMemo(() => {\n    if (query === null) {\n      if (value !== null) {\n        return renderValue(value, currentOption);\n      }\n      return \"\";\n    }\n    return query;\n  }, [currentOption, query, renderValue, value]);\n  const input = /* @__PURE__ */ React.createElement(TextInput, __spreadProps(__spreadValues({}, restProps), {\n    \"aria-activedescendant\": activeItemId,\n    \"aria-autocomplete\": \"list\",\n    \"aria-expanded\": expanded,\n    \"aria-owns\": listBoxId,\n    autoCapitalize: \"off\",\n    autoComplete: \"off\",\n    autoCorrect: \"off\",\n    border,\n    clearButton,\n    customValidity,\n    disabled,\n    fontSize,\n    icon,\n    iconRight: loading && AnimatedSpinnerIcon,\n    id,\n    inputMode: \"search\",\n    onChange: handleInputChange,\n    onClear: handleClearButtonClick,\n    onFocus: handleInputFocus,\n    padding,\n    prefix,\n    radius,\n    readOnly,\n    ref: setRef,\n    role: \"combobox\",\n    spellCheck: false,\n    suffix: openButtonNode,\n    value: inputValue\n  }));\n  const handleListBoxKeyDown = useCallback((event) => {\n    var _a2;\n    if (event.key === \"Tab\") {\n      if (listFocused)\n        (_a2 = inputElementRef.current) == null ? void 0 : _a2.focus();\n    }\n  }, [listFocused]);\n  const content = useMemo(() => {\n    if (filteredOptions.length === 0)\n      return null;\n    return /* @__PURE__ */ React.createElement(ListBox, __spreadProps(__spreadValues({\n      onKeyDown: handleListBoxKeyDown,\n      padding: 1\n    }, listBox), {\n      tabIndex: -1\n    }), /* @__PURE__ */ React.createElement(Stack, {\n      as: \"ul\",\n      \"aria-multiselectable\": false,\n      id: listBoxId,\n      ref: listBoxElementRef,\n      role: \"listbox\",\n      space: 1\n    }, filteredOptions.map((option) => {\n      const active = activeValue !== null ? option.value === activeValue : currentOption === option;\n      return /* @__PURE__ */ React.createElement(AutocompleteOption, {\n        id: `${id}-option-${option.value}`,\n        key: option.value,\n        onSelect: handleOptionSelect,\n        selected: active,\n        value: option.value\n      }, cloneElement(renderOption(option), {\n        disabled: loading,\n        selected: active,\n        tabIndex: listFocused && active ? 0 : -1\n      }));\n    })));\n  }, [\n    activeValue,\n    currentOption,\n    filteredOptions,\n    handleOptionSelect,\n    handleListBoxKeyDown,\n    id,\n    listBox,\n    listBoxId,\n    listFocused,\n    loading,\n    renderOption\n  ]);\n  const results = useMemo(() => {\n    if (renderPopover) {\n      return renderPopover({ content, hidden: !expanded, inputElement: inputElementRef.current }, setResultsPopoverElement);\n    }\n    if (filteredOptionsLen === 0) {\n      return null;\n    }\n    return /* @__PURE__ */ React.createElement(ResultsPopover, __spreadValues({\n      __unstable_margins: AUTOCOMPLETE_POPOVER_MARGINS,\n      arrow: false,\n      constrainSize: true,\n      content,\n      fallbackPlacements: AUTOCOMPLETE_POPOVER_FALLBACK_PLACEMENTS,\n      matchReferenceWidth: true,\n      onMouseEnter: handlePopoverMouseEnter,\n      onMouseLeave: handlePopoverMouseLeave,\n      open: expanded,\n      placement: AUTOCOMPLETE_POPOVER_PLACEMENT,\n      portal: true,\n      radius,\n      ref: setResultsPopoverElement,\n      referenceElement: inputElementRef.current\n    }, popover));\n  }, [\n    content,\n    expanded,\n    filteredOptionsLen,\n    handlePopoverMouseEnter,\n    handlePopoverMouseLeave,\n    popover,\n    radius,\n    renderPopover\n  ]);\n  return /* @__PURE__ */ React.createElement(Root, {\n    \"data-ui\": \"Autocomplete\",\n    onBlur: handleRootBlur,\n    onFocus: handleRootFocus,\n    onKeyDown: handleRootKeyDown,\n    ref: setRootElement\n  }, input, results);\n});\nconst Autocomplete = InnerAutocomplete;\nexport {\n  Autocomplete\n};\n"]},"metadata":{},"sourceType":"module"}