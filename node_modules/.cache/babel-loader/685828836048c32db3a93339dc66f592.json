{"ast":null,"code":"import _slicedToArray from \"/home/ihartsykala/projects/playy/media_brouser_local_public/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _toConsumableArray from \"/home/ihartsykala/projects/playy/media_brouser_local_public/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _createForOfIteratorHelper from \"/home/ihartsykala/projects/playy/media_brouser_local_public/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { EMPTY_ARRAY } from \"../constants\";\n\nfunction _getElements(element, elementsArg) {\n  var ret = [element];\n\n  var _iterator = _createForOfIteratorHelper(elementsArg),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var el = _step.value;\n\n      if (Array.isArray(el)) {\n        ret.push.apply(ret, _toConsumableArray(el));\n      } else {\n        ret.push(el);\n      }\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  return ret.filter(Boolean);\n}\n\nfunction useClickOutside(listener) {\n  var elementsArg = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : EMPTY_ARRAY;\n  var boundaryElement = arguments.length > 2 ? arguments[2] : undefined;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      element = _useState2[0],\n      setElement = _useState2[1];\n\n  var _useState3 = useState(function () {\n    return _getElements(element, elementsArg);\n  }),\n      _useState4 = _slicedToArray(_useState3, 2),\n      elements = _useState4[0],\n      setElements = _useState4[1];\n\n  var elementsRef = useRef(elements);\n  useEffect(function () {\n    var prevElements = elementsRef.current;\n\n    var nextElements = _getElements(element, elementsArg);\n\n    if (prevElements.length !== nextElements.length) {\n      setElements(nextElements);\n      elementsRef.current = nextElements;\n      return;\n    }\n\n    var _iterator2 = _createForOfIteratorHelper(prevElements),\n        _step2;\n\n    try {\n      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n        var el = _step2.value;\n\n        if (!nextElements.includes(el)) {\n          setElements(nextElements);\n          elementsRef.current = nextElements;\n          return;\n        }\n      }\n    } catch (err) {\n      _iterator2.e(err);\n    } finally {\n      _iterator2.f();\n    }\n\n    var _iterator3 = _createForOfIteratorHelper(nextElements),\n        _step3;\n\n    try {\n      for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n        var _el = _step3.value;\n\n        if (!prevElements.includes(_el)) {\n          setElements(nextElements);\n          elementsRef.current = nextElements;\n          return;\n        }\n      }\n    } catch (err) {\n      _iterator3.e(err);\n    } finally {\n      _iterator3.f();\n    }\n  }, [element, elementsArg]);\n  useEffect(function () {\n    if (!listener) return void 0;\n\n    var handleWindowMouseDown = function handleWindowMouseDown(evt) {\n      var target = evt.target;\n\n      if (!(target instanceof Node)) {\n        return;\n      }\n\n      if (boundaryElement && !boundaryElement.contains(target)) {\n        return;\n      }\n\n      var _iterator4 = _createForOfIteratorHelper(elements),\n          _step4;\n\n      try {\n        for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n          var el = _step4.value;\n\n          if (target === el || el.contains(target)) {\n            return;\n          }\n        }\n      } catch (err) {\n        _iterator4.e(err);\n      } finally {\n        _iterator4.f();\n      }\n\n      listener(evt);\n    };\n\n    window.addEventListener(\"mousedown\", handleWindowMouseDown);\n    return function () {\n      window.removeEventListener(\"mousedown\", handleWindowMouseDown);\n    };\n  }, [boundaryElement, listener, elements]);\n  return setElement;\n}\n\nexport { useClickOutside };","map":{"version":3,"sources":["/home/ihartsykala/projects/playy/media_brouser_local_public/node_modules/@sanity/ui/lib/esm/hooks/useClickOutside.js"],"names":["useEffect","useRef","useState","EMPTY_ARRAY","_getElements","element","elementsArg","ret","el","Array","isArray","push","filter","Boolean","useClickOutside","listener","boundaryElement","setElement","elements","setElements","elementsRef","prevElements","current","nextElements","length","includes","handleWindowMouseDown","evt","target","Node","contains","window","addEventListener","removeEventListener"],"mappings":"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","sourcesContent":["import { useEffect, useRef, useState } from \"react\";\nimport { EMPTY_ARRAY } from \"../constants\";\nfunction _getElements(element, elementsArg) {\n  const ret = [element];\n  for (const el of elementsArg) {\n    if (Array.isArray(el)) {\n      ret.push(...el);\n    } else {\n      ret.push(el);\n    }\n  }\n  return ret.filter(Boolean);\n}\nfunction useClickOutside(listener, elementsArg = EMPTY_ARRAY, boundaryElement) {\n  const [element, setElement] = useState(null);\n  const [elements, setElements] = useState(() => _getElements(element, elementsArg));\n  const elementsRef = useRef(elements);\n  useEffect(() => {\n    const prevElements = elementsRef.current;\n    const nextElements = _getElements(element, elementsArg);\n    if (prevElements.length !== nextElements.length) {\n      setElements(nextElements);\n      elementsRef.current = nextElements;\n      return;\n    }\n    for (const el of prevElements) {\n      if (!nextElements.includes(el)) {\n        setElements(nextElements);\n        elementsRef.current = nextElements;\n        return;\n      }\n    }\n    for (const el of nextElements) {\n      if (!prevElements.includes(el)) {\n        setElements(nextElements);\n        elementsRef.current = nextElements;\n        return;\n      }\n    }\n  }, [element, elementsArg]);\n  useEffect(() => {\n    if (!listener)\n      return void 0;\n    const handleWindowMouseDown = (evt) => {\n      const target = evt.target;\n      if (!(target instanceof Node)) {\n        return;\n      }\n      if (boundaryElement && !boundaryElement.contains(target)) {\n        return;\n      }\n      for (const el of elements) {\n        if (target === el || el.contains(target)) {\n          return;\n        }\n      }\n      listener(evt);\n    };\n    window.addEventListener(\"mousedown\", handleWindowMouseDown);\n    return () => {\n      window.removeEventListener(\"mousedown\", handleWindowMouseDown);\n    };\n  }, [boundaryElement, listener, elements]);\n  return setElement;\n}\nexport {\n  useClickOutside\n};\n"]},"metadata":{},"sourceType":"module"}